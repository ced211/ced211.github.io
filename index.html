<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GAN for audio inpainting and prediction</title>
</head>
<body>
<h2 id="inpainting-an-prediction-gan-for-audio">A generative adversarial approach for audio inpainting</h2>
<p> InpaintingGAN, IGAN in short, is a neural network designed to inpaint magnitude spectrums. It can be trained to inpaint the
    magnitude
    spectrum of an audio frame of length T seconds, given the previous and subsequent T seconds. PredicitonGAN or PGAN
    is
    an adaptation of IGAN to perform audio prediction. It can be trained to predict an audio frame of T seconds, given
    the T previous seconds. This web page accompaing the <a href="https://github.com/ced211/master_thesis.git">github
        repository</a>.</p>
<h3 id="igan">IGAN</h3>
<p>Here are some samples output by IGAN for T=0.064. To reconstruct the audio from the magnitude spectrums, the
    Griffin-Lim algorithm was used. As shown in the various examples, the reconstructed spectrums are rather good,
    even if they are blurred. The audio waveforms look similar to the ground truth even if they are
    not close
    from them. It might be because the Griffin-Lim does not output the exact waveform, even if it is fed
    with the real magnitude. Moreover, it works from an approximation of the real magnitude spectrum. To obtain this
    result, IGAN was trained for 200 epochs on the small FMA dataset. The network
    performance can be probably improved by letting it train longer. </p>
<table class="center" id="igan_64">
    <tr>
        <th> Spectrum</th>
        <th> Waveform</th>
    </tr>
    <tr>
        <td><img src="Samples/IGAN/0.128/batch_2_rec_vs_original_spectrum_sample_59.png"/></td>
        <td><img src="Samples/IGAN/0.128/batch_2_rec_vs_original_audio_sample_59.png"/></td>
    </tr>
    <tr>
        <td><img src="Samples/IGAN/0.128/batch_0_rec_vs_original_spectrum_sample_174.png"</td>
        <td><img src="Samples/IGAN/0.128/batch_0_rec_vs_original_audio_sample_174.png"</td>
    </tr>
    <tr>
        <td><img src="Samples/IGAN/0.128/batch_8_rec_vs_original_spectrum_sample_168.png"</td>
        <td><img src="Samples/IGAN/0.128/batch_8_rec_vs_original_audio_sample_168.png"</td>
    </tr>
</table>
<table>
    <tr>
        <th> Original Audio</th>
        <th> Reconstructed Audio</th>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.128/batch_2_or_sample_59.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.128/batch_2_rec_sample_59.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.128/batch_0_or_sample_174.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.128/batch_0_rec_sample_174.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.128/batch_8_or_sample_168.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.128/batch_8_rec_sample_168.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
</table>

<p>Here are other samples for T=0.128. One can notice that the reconstruction quality is lower, especially in the first
    example which is a bad one. </p>

<table class="center" id="igan_128">
    <tr>
        <th> Spectrum</th>
        <th> Waveform</th>
    </tr>
    <tr>
        <td><img src="Samples/IGAN/0.384/batch_0_rec_vs_original_spectrum_sample_3.png"/></td>
        <td><img src="Samples/IGAN/0.384/batch_0_rec_vs_original_audio_sample_3.png"</td>
    </tr>
    <tr>
        <th><img src="Samples/IGAN/0.384/batch_1_rec_vs_original_spectrum_sample_18.png"</th>
        <th><img src="Samples/IGAN/0.384/batch_1_rec_vs_original_audio_sample_18.png"</th>
    </tr>
    <tr>
        <th><img src="Samples/IGAN/0.384/batch_2_rec_vs_original_spectrum_sample_97.png"</th>
        <th><img src="Samples/IGAN/0.384/batch_1_rec_vs_original_audio_sample_18.png"</th>
    </tr>
</table>
<table>
    <tr>
        <th> Original Audio</th>
        <th> Reconstructed Audio</th>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.384/batch_0_or_sample_3.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.384/batch_0_rec_sample_3.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.384/batch_1_or_sample_18.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.384/batch_1_rec_sample_18.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.384/batch_2_or_sample_97.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.384/batch_2_rec_sample_97.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
</table>


<h3 id="igan">PGAN</h3>
<p>
    PGAN is an adaptation of IGAN for audio prediction. The neural network predicts the magnitude spectrum of an
    audio frame of length T given the T previous seconds. On the examples below, one can see that PGAN perform less well
    than IGAN. It is because the new task is much more
    challenging. However, the result are still interesting. The example are obtained with T = 0.064.
</p>
<table class="center" id="pgan_128">
    <tr>
        <th> Spectrum</th>
        <th> Waveform</th>
    </tr>
    <tr>
        <td><img src="Samples/PGAN/batch_3_rec_vs_original_spectrum_sample_63.png"/></td>
        <td><img src="Samples/PGAN/batch_3_rec_vs_original_audio_sample_63.png"</td>
    </tr>
    <tr>
        <th><img src="Samples/PGAN/batch_4_rec_vs_original_spectrum_sample_25.png"</th>
        <th><img src="Samples/PGAN/batch_4_rec_vs_original_audio_sample_25.png"</th>
    </tr>
    <tr>
        <th><img src="Samples/PGAN/batch_5_rec_vs_original_spectrum_sample_254.png"</th>
        <th><img src="Samples/PGAN/batch_5_rec_vs_original_audio_sample_254.png"</th>
    </tr>
</table>
<table>
    <tr>
        <th> Original Audio</th>
        <th> Reconstructed Audio</th>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/PGAN/batch_3_or_sample_63.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/PGAN/batch_3_rec_sample_63.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/PGAN/batch_4_or_sample_25.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/PGAN/batch_4_rec_sample_25.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/PGAN/batch_5_or_sample_254.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/PGAN/batch_5_rec_sample_254.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
</table>

<h3> Perceptual Evaluation</h3>
<p>
    To perceptually evaluate the model, we use it to fill in one gap of T = 0.064s, located at 0.5s in an audio sample
    of two seconds. Then, we run a
    matlab function to compute the ODG between the original audio and the audio with the filled gap. The examples below
    are obtained with IGAN with T = 0.064.
</p>
<p>
    On the last example of this section, one can heard that IGAN does
    it job. Indeed, it is very difficult to heard a difference between the original and the reconstructed one while the
    difference is audible between the original audio and the one with the hole. In the second example, it is difficult
    to heard a difference between the original audio, and the one with the hole. This is probably because the hole come
    when the song is rather silent. Still, we can notice that IGAN doesn't put annoying noise instead of the silence.
</p>
<table>
    <tr>
        <th> Original Audio</th>
        <th> Reconstructed Audio</th>
        <th> Audio with hole</th>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/or_batch_12_sample_186.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/rec_batch_12_sample_186.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/hole_batch_12_sample_186.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/or_batch_3_sample_230.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/rec_batch_3_sample_230.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/hole_batch_3_sample_230.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/or_batch_10_sample_150.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/rec_batch_10_sample_150.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/hole_batch_10_sample_150.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
</table>
<h3> Chaining prediction</h3>

<p>
    The considered frame length, 0.064, is very short.
    Previously, we fill in a gap 0.064 ms in an audio of 2s length.
    In this experiment, we reconstruct the whole 2s long audio by frame of 64ms.
    Each frame of 64ms are reconstructed using IGAN, with as input the previous and subsequent 64ms, taken
    from the original audio.
    Then, all the predicted frames are concatenated together. As shown in the examples below, the audios are easily
    recognizable, even if they are noisy. The noise might come from a possible discontinuity at the intersection of two frames.
</p>
<table>
    <tr>
        <th> Original Audio</th>
        <th> Reconstructed Audio</th>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/chaining/igan/or_chaining_21.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/chaining/igan/rec_chaining_21.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>

    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/chaining/igan/or_chaining_157.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/chaining/igan/rec_chaining_157.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/chaining/igan/or_chaining_457.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/chaining/igan/rec_chaining_457.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
</table>
<p>
    In this experiment, we do the same than previously, but with PGAN.
    Each frame of 64ms are first reconstructed using PGAN, with as input the previous frame, taken
    from the original audio.
    Then, all the predicted frames are concatenated together. As shown in the examples below, the audios are easily
    recognizable, even if they are noisy.</p>

<table>
    <tr>
        <th> Original Audio</th>
        <th> Reconstructed Audio</th>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/chaining/pgan/or_chaining_21.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/chaining/pgan/rec_chaining_21.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>

    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/chaining/pgan/or_chaining_157.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/chaining/pgan/rec_chaining_157.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/chaining/pgan/or_chaining_457.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/chaining/pgan/rec_chaining_457.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
</table>


<h3> Generalization </h3>
<p>
    To test our model generalization ability, we used it to inpaint on the MAESTRO dataset while training it on the
    small version of the FMA dataset. The FMA dataset is composed of 3000 tracks of 30s of 8 different music styles
    while
    the MAESTRO dataset is composed of classical piano records. The example below are obtained with IGAN with T = 0.064.
    When comparing these examples with the ones shown <a href="#igan_64"> previously</a>, one can see that IGAN behaves
    in the same way in both case. Thus, the model generalization ability seems to be nice.
</p>
<table class="center">
    <tr>
        <th> Spectrum</th>
        <th> Waveform</th>
    </tr>
    <tr>
        <td><img src="Samples/Generalization/batch_0_rec_vs_original_spectrum_sample_125.png" width="640" height="480"/>
        </td>
        <td><img src="Samples/Generalization/batch_0_rec_vs_original_audio_sample_125.png" width="640" height="480"/>
        </td>
    </tr>
    <tr>
        <th><img src="Samples/Generalization/batch_1_rec_vs_original_spectrum_sample_145.png"</th>
        <th><img src="Samples/Generalization/batch_1_rec_vs_original_audio_sample_145.png"</th>
    </tr>
    <tr>
        <th><img src="Samples/Generalization/batch_2_rec_vs_original_spectrum_sample_79.png"</th>
        <th><img src="Samples/Generalization/batch_2_rec_vs_original_audio_sample_79.png"</th>
    </tr>
</table>
<table>
    <tr>
        <th> Original Audio</th>
        <th> Reconstructed Audio</th>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/Generalization/batch_0_or_sample_125.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/Generalization/batch_0_rec_sample_125.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/Generalization/batch_1_or_sample_145.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/Generalization/batch_1_rec_sample_145.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/Generalization/batch_2_or_sample_79.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/Generalization/batch_2_rec_sample_79.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
</table>

<h3> Reference</h3>
<p>
    <cite>"Enabling
        Factorized Piano Music Modeling and Generation with the MAESTRO Dataset." </cite>, Curtis Hawthorne, Andriy
    Stasyuk, Adam Roberts, Ian Simon, Cheng-Zhi Anna Huang,
    Sander Dieleman, Erich Elsen, Jesse Engel, and Douglas Eck.
    In International Conference on Learning Representations, 2019.
</p>
<p>
    <cite>A Dataset for Music Analysis</cite>, Defferrard, Michael and Benzi, Kirell and Vandergheynst, Pierre and
    Bresson, Xavier. In 18th International Society for Music Information Retrieval Conference (ISMIR)
</p>
</body>
</html>
