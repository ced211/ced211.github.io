<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GAN for audio inpainting and prediction</title>
</head>
<body>
<h2 id="inpainting-an-prediction-gan-for-audio">Inpainting and Prediction GAN for audio</h2>
<p> InpaintingGAN, IGAN in short, is a neural network to inpaint magnitude spectrums. It can be trained to inpaint the
    magnitude
    spectrum of an audio frame of length T seconds, given the previous and subsequent T seconds. PredicitonGAN or PGAN
    is
    an adaptation of IGAN to perform audio prediction. It can be trained to predict an audio frame of T seconds, given
    the T previous seconds. This web page accompaing the <a href="https://github.com/ced211/master_thesis.git">github
        repository</a>.</p>
<h3 id="igan">IGAN</h3>
<p>Here are some samples output by IGAN for T=0.064. To reconstruct the audio from the magnitude spectrums, the
    Griffin-Lim algorithm was used. As shown in the various examples, the reconstructed spectrums are rather good,
    even if they are blurred. On the other hand, the audio waveforms look similar to the ground truth even if they are
    not close
    from them. This is explained because the Griffin-Lim does not output the exact waveform, even if it is fed
    with the real magnitude. Moreover, it works from an approximation of the real magnitude spectrum. To obtain this
    result, IGAN was trained for 200 epochs on the small FMA dataset. The network
    performance can be probably improved by letting it train longer. </p>
<table class="center" id="igan_64">
    <tr>
        <th> Spectrum</th>
        <th> Waveform</th>
    </tr>
    <tr>
        <td><img src="Samples/IGAN/0.128/batch_2_rec_vs_original_spectrum_sample_59.png" width="640" height="480"/></td>
        <td><img src="Samples/IGAN/0.128/batch_2_rec_vs_original_audio_sample_59.png" width="640" height="480"/></td>
    </tr>
    <tr>
        <th><img src="Samples/IGAN/0.128/batch_0_rec_vs_original_spectrum_sample_174.png"</th>
        <th><img src="Samples/IGAN/0.128/batch_0_rec_vs_original_audio_sample_174.png"</th>
    </tr>
    <tr>
        <th><img src="Samples/IGAN/0.128/batch_8_rec_vs_original_spectrum_sample_168.png"</th>
        <th><img src="Samples/IGAN/0.128/batch_8_rec_vs_original_audio_sample_168.png"</th>
    </tr>
</table>
<table>
    <tr>
        <th> Original Audio</th>
        <th> Reconstructed Audio</th>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.128/batch_2_or_sample_59.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.128/batch_2_rec_sample_59.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.128/batch_0_or_sample_174.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.128/batch_0_rec_sample_174.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.128/batch_8_or_sample_168.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/IGAN/0.128/batch_8_rec_sample_168.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
</table>

<p>Here are other sample for T=0.128 </p>


<h3 id="igan">PGAN</h3>
<p>
    PGAN is an adaptation of IGAN for audio prediction. The neural network predicts the magnitude spectrum of an
    audio frame of length T given the T previous seconds.
</p>
<p>
    On the examples below, one can see that PGAN perform less well than IGAN. It is because the new task is much more
    challenging. However, the result are still interesting.
</p>
<h3> Perceptual Evaluation</h3>
<p>
    To perceptually evaluate the model, we use it to fill in one gap of T = 0.064s, located at 0.5s in an audio sample
    of two seconds. Then, we run a
    matlab function to compute the ODG between the original audio and the audio with the filled gap. The example below
    are obtained with IGAN with T = 0.064.
</p>
<p>
    On the first and last example of this section, one can heard that IGAN does
    it job. Indeed, it is very difficult to heard a difference between the original and the reconstructed one while the
    difference is audible between the original audio and the one with the hole. In the second example, it is difficult
    to heard a difference between the original audio, and the one with the hole. This is probably because the hole come
    when the song is rather silent. Still, we can notice that IGAN doesn't put annoying noise instead of the silence.
</p>
<table>
    <tr>
        <th> Original Audio</th>
        <th> Reconstructed Audio</th>
        <th> Audio with hole</th>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/or_batch_12_sample_186.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/rec_batch_12_sample_186.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/hole_batch_12_sample_186.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/or_batch_3_sample_230.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/rec_batch_3_sample_230.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/hole_batch_3_sample_230.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/or_batch_10_sample_150.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/rec_batch_10_sample_150.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="./Samples/PerceptualTest/single_hole/hole_batch_10_sample_150.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
</table>
<h3> Generalization </h3>
<p>
    To test our model generalization ability, we used it to inpaint on the MAESTRO dataset while training it on the
    small version of the FMA dataset. The FMA dataset is composed of 3000 tracks of 30s of 8 different music styles
    while
    the MAESTRO dataset is composed of classical piano records. The example below are obtained with IGAN with T = 0.064.
    When comparing these examples with the one shows <a href="#igan_64"> previously</a>, one can see that IGAN behaves
    in the same way in both case. Thus, the model generalization ability seems to be nice.
</p>
<table class="center">
    <tr>
        <th> Spectrum</th>
        <th> Waveform</th>
    </tr>
    <tr>
        <td><img src="Samples/Generalization/batch_0_rec_vs_original_spectrum_sample_125.png" width="640" height="480"/>
        </td>
        <td><img src="Samples/Generalization/batch_0_rec_vs_original_audio_sample_125.png" width="640" height="480"/>
        </td>
    </tr>
    <tr>
        <th><img src="Samples/Generalization/batch_1_rec_vs_original_spectrum_sample_145.png"</th>
        <th><img src="Samples/Generalization/batch_1_rec_vs_original_audio_sample_145.png"</th>
    </tr>
    <tr>
        <th><img src="Samples/Generalization/batch_2_rec_vs_original_spectrum_sample_79.png"</th>
        <th><img src="Samples/Generalization/batch_2_rec_vs_original_audio_sample_79.png"</th>
    </tr>
</table>
<table>
    <tr>
        <th> Original Audio</th>
        <th> Reconstructed Audio</th>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/Generalization/batch_0_or_sample_125.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/Generalization/batch_0_rec_sample_125.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/Generalization/batch_1_or_sample_145.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/Generalization/batch_1_rec_sample_145.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
    </tr>
    <tr>
        <td>
            <audio controls=" ">
                <source src="Samples/Generalization/batch_2_or_sample_79.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
        <td>
            <audio controls=" ">
                <source src="Samples/Generalization/batch_2_rec_sample_79.wav" type="audio/wav">
                Your browser does not support the audio element.
            </audio>
        </td>
    </tr>
</table>

<h3> Reference</h3>
<p>
    <cite>"Enabling
        Factorized Piano Music Modeling and Generation with the MAESTRO Dataset." </cite>, Curtis Hawthorne, Andriy
    Stasyuk, Adam Roberts, Ian Simon, Cheng-Zhi Anna Huang,
    Sander Dieleman, Erich Elsen, Jesse Engel, and Douglas Eck.
    In International Conference on Learning Representations, 2019.
</p>
<p>
    <cite>A Dataset for Music Analysis</cite>, Defferrard, Michael and Benzi, Kirell and Vandergheynst, Pierre and
    Bresson, Xavier. In 18th International Society for Music Information Retrieval Conference (ISMIR)
</p>
</body>
</html>